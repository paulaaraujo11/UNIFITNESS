!function e(t,a,o){function i(s,r){if(!a[s]){if(!t[s]){var c="function"==typeof require&&require;if(!r&&c)return c(s,!0);if(n)return n(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=a[s]={exports:{}};t[s][0].call(d.exports,function(e){var a=t[s][1][e];return i(a?a:e)},d,d.exports,e,t,a,o)}return a[s].exports}for(var n="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),r=e("./request"),c=o(r),u=e("./msk"),d=o(u),p=function(){function e(t){i(this,e),this.base_api=t,this.anonymous=!1,this.browser_id=!1,this.client_id=!1,this.customer_id=!1,this.access_token=!1,this.queue=[],this.running=!1,this.data={},this.msk=new d["default"](this.base_api)}return s(e,[{key:"updateAnonymousData",value:function(e){this.anonymous=e}},{key:"updateBrowser",value:function(e){this.browser_id=e,this.run()}},{key:"updateClient",value:function(e){this.msk.updateClient(e),this.client_id=e,this.run()}},{key:"updateCustomer",value:function(e){this.msk.updateCustomer(e),this.customer_id=e,this.run()}},{key:"updateAccessToken",value:function(e){this.msk.updateAccessToken(e),this.access_token=e,this.run()}},{key:"delayedCall",value:function(e){e.callback||(e.callback=function(e,t){}),this.queue.push(e),this.run()}},{key:"asyncCall",value:function(e,t){setTimeout(function(){e.apply(e,t)},0)}},{key:"run",value:function(){var e=this;if(!this.running&&this.browser_id&&this.client_id&&this.customer_id&&this.access_token&&0!==this.queue.length){this.running=!0;var t=this.queue.pop();t.attempts||(t.attempts=1);var a=t.route;a=a.replace("{{browser_id}}",this.browser_id),a=a.replace("{{client_id}}",this.client_id),a=a.replace("{{customer_id}}",this.customer_id),(0,c["default"])(t.method,this.base_api+a,function(a,o){a&&!o?e.asyncCall(t.callback,[a,null]):o&&(t.attempts<=2&&e.onRequestError?e.asyncCall(e.onRequestError,[o,t]):e.asyncCall(t.callback,[null,a])),e.running=!1,e.queue.length>0&&e.run()},t.data,this.access_token)}}},{key:"auth",value:function(e,t){return e?("object"===n(this.anonymous)&&(e.history=JSON.stringify(this.anonymous)),void(0,c["default"])("POST",this.base_api+"auth/customer",t,e)):void t(null,new Error("Invalid data"))}},{key:"getRecommendations",value:function(e,t){this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/recommendations",data:{metadata:JSON.stringify(e)},callback:t})}},{key:"getLastViewed",value:function(e,t){this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/products",data:{metadata:JSON.stringify(e)},callback:t})}},{key:"setContact",value:function(e,t){var a=this;"object"===("undefined"==typeof e?"undefined":n(e))&&(this.data.contact=e,e={metadata:JSON.stringify(e)},this.msk.execute(e,function(e,o){e&&!o&&a.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/contacts/save",data:e,callback:t})}))}},{key:"tracking",value:function(e,t){this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/start",data:{metadata:JSON.stringify(e)},callback:t})}},{key:"trackingPage",value:function(e,t){"object"===("undefined"==typeof e?"undefined":n(e))&&(this.data.page=e,"product"!==this.data.page.type&&"category"!==this.data.page.type&&"search"!==this.data.page.type||this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/pageview",data:{metadata:JSON.stringify({page:e.type,details:e.metadata})},callback:t}))}},{key:"trackingInteraction",value:function(e,t){this.data.interaction=e,this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/interaction",data:{metadata:JSON.stringify(e)},callback:t})}},{key:"trackingEvent",value:function(e,t){this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/event",data:{metadata:JSON.stringify(e)},callback:t})}},{key:"trackingCart",value:function(e,t){"object"===("undefined"==typeof e?"undefined":n(e))&&(this.data.cart=e.metadata,this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/cart",data:{metadata:JSON.stringify({cart:e.cart,products:e.metadata,info:e.information})},callback:t}))}},{key:"trackingOrder",value:function(e,t){"object"===("undefined"==typeof e?"undefined":n(e))&&(this.data.order=e.metadata,this.delayedCall({method:"POST",route:"clients/{{client_id}}/customers/{{customer_id}}/tracking/order",data:{metadata:JSON.stringify({order:e.order,cart:e.cart,details:e.metadata,info:e.information})},callback:t}))}}]),e}();a["default"]=p},{"./msk":8,"./request":9}],2:[function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),r=e("./cookie"),c=e("./request"),u=o(c),d=e("./load-resource"),p=o(d),l=e("./languages"),f=o(l),h=function(){function e(t,a,o){i(this,e),this.base_api=t,this.base_statics=a,this.templates={},this.language=o,this.languages=new f["default"],this.config={SHOPPUSH:{PLUGIN:this.base_statics+"tags/plugins/shoppush.js?version=1.1",TEMPLATE_JS:this.base_statics+"tags/templates/shoppush.js?version=1.1",TEMPLATE_CSS:this.base_statics+"tags/templates/css/shoppush.css?version=1.1",IMAGE_ICON:this.base_statics+"shopback/assets/images/shopback.png?version=1.1",IMAGE_BELL:this.base_statics+"shoppush/assets/images/shoppush-bell.png?version=1.1",IMAGE_BELL_WHITE:this.base_statics+"shoppush/assets/images/shoppush-bell-white.png?version=1.1",CLIENT_DOMAIN:String(document.domain)},SHOPSMART:{PLUGIN:this.base_statics+"tags/plugins/shopsmart.js?version=1.1",TEMPLATE_JS:this.base_statics+"tags/templates/shopsmart.js?version=1.1",TEMPLATE_CSS:this.base_statics+"tags/templates/css/shopsmart.css?version=1.1",CLIENT_DOMAIN:String(document.domain)},SHOPLIVE:{PLUGIN:this.base_statics+"tags/plugins/shoplive.js?version=1.1",TEMPLATE_JS:this.base_statics+"tags/templates/shoplive.js?version=1.1",TEMPLATE_CSS:this.base_statics+"tags/templates/css/shoplive.css?version=1.1",IMAGE_ICON:this.base_statics+"shopback/assets/images/shopback.png?version=1.1",IMAGE_BELL:this.base_statics+"shoppush/assets/images/shoppush-bell.png?version=1.1",IMAGE_BELL_WHITE:this.base_statics+"shoppush/assets/images/shoppush-bell-white.png?version=1.1",CLIENT_DOMAIN:String(document.domain)},SHOPBOT:{PLUGIN:this.base_statics+"tags/plugins/shopbot.js?version=1.1",TEMPLATE_JS:this.base_statics+"tags/templates/shopbot.js?version=1.1",TEMPLATE_CSS:this.base_statics+"tags/templates/css/shopbot.css?version=1.1",CLIENT_DOMAIN:String(document.domain)}},"object"===n(window.shopback)&&window.shopback&&"function"==typeof window.shopback.jQuery&&window.shopback.jQuery?this.$=window.shopback.jQuery:this.$=!1,this.$||"function"!=typeof window.jQuery||(this.$=window.jQuery),this.contacts={}}return s(e,[{key:"initialize",value:function(e,t){if(!this.$)return!1;if(this.contacts=t,0!==e.length)for(var a=0;a<e.length;a++)this.loadCampaign(e[a])}},{key:"loadCampaign",value:function(e){var t=this;if("closed"!==(0,r.getCookie)("sback_campaign_"+e.id)&&("shoppush"!==e.platform||this.contacts.webpush!==!0))return"undefined"==typeof this.config[e.platform.toUpperCase()].PLUGIN||window[e.platform]?"undefined"==typeof this.config[e.platform.toUpperCase()].TEMPLATE_JS||this.templates[e.platform]?"undefined"==typeof this.config[e.platform.toUpperCase()].TEMPLATE_CSS||this.$('link[href$="'+this.config[e.platform.toUpperCase()].TEMPLATE_CSS+'"]').length?void("shoppush"===e.platform?this.prepareShoppush(e):"shopsmart"===e.platform?this.watchShopsmart(e):"shoplive"===e.platform?this.watchShoplive(e):"shopbot"===e.platform&&this.watchShopbot(e)):void this.loadDependency(e,"TEMPLATE_CSS",!1,"css"):void this.loadDependency(e,"TEMPLATE_JS",function(){t.templates[e.platform]=window[e.platform+"_templates"]||{},window[e.platform+"_templates"]=null}):void this.loadDependency(e,"PLUGIN")}},{key:"prepareShoppush",value:function(e){var t=this;if("Notification"in window&&"serviceWorker"in navigator||"safari"in window&&"pushNotification"in window.safari){var a=this.languages.request(this.language,e.platform,!1);if("default"===e.template.type)window.shoppush.showRequest(e.id,e.settings,e.close.duration,e.info.manifest,a,e.template),this.setInteraction("shoppush",e.id,"view");else if("custom"===e.template.type)if(this.$("body").append('<div id="shopback-'+e.id+'" class="shoppush-container"></div>'),e.template.content.image_thumb=e.settings.icon.url,this.$("#shopback-"+e.id).attr("data-platform",e.platform).attr("data-close",e.close.duration).html(this.requestTemplate("shoppush",e.template.content)),this.$("#shopback-"+e.id+" .shoppush-prompt-close").bind("click",function(a){t.closeCampaign(e.id,!1)}),this.$("#shopback-"+e.id+" .shoppush-disallow-btn").bind("click",function(a){t.closeCampaign(e.id,!1)}),this.$("#shopback-"+e.id+" .shoppush-accept-btn").bind("click",function(o){window.shoppush.showRequest(e.id,e.settings,e.close.duration,e.info.manifest,a,e.template),t.setInteraction("shoppush",e.id,"click"),t.closeCampaign(e.id,!1)}),"site"===e.template.content.font&&this.$("#shopback-"+e.id+" .shoppush-prompt-with-font").removeClass("shoppush-prompt-with-font"),"disabled"===e.template.content.buttons&&(this.$("#shopback-"+e.id+" .shoppush-prompt-btn").remove(),this.$("#shopback-"+e.id+" .shoppush-prompt").css("cursor","pointer"),this.$("#shopback-"+e.id+" .shoppush-prompt").bind("click",function(o){window.shoppush.showRequest(e.id,e.settings,e.close.duration,e.info.manifest,a,e.template),t.setInteraction("shoppush",e.id,"click"),t.closeCampaign(e.id,!1)})),e.template.content.powered===!1&&this.$("#shopback-"+e.id+" .powered-link-wrapper").remove(),"click-element"===e.trigger)this.$(".shoppush_notify_prompt").bind("click",function(a){t.showCampaign(e.id),t.setInteraction("shoppush",e.id,"view")});else{if(this.showCampaign(e.id),"undefined"!=typeof e.close.auto_close){this.closeCampaign(e.id,e.close.auto_close.duration);var o=1e3*e.close.auto_close.delay;setTimeout(function(){var a=t.$("#shopback-"+e.id);a.remove(),t.$(".shoppush-container").remove(),t.$(".shoppush-container-show").remove()},o)}this.setInteraction("shoppush",e.id,"view")}}}},{key:"watchShopsmart",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this,a=window.shopback.client_id,o=window.shopback.currentProducts();if(a&&o.length>0){var o=o.join(",");(0,u["default"])("GET",this.base_api+"clients/"+a+"/products/"+o+"/cross_selling",function(a,o){if(a&&!o&&a.data.length>0){var i=a.data[0];i.image=i.images[0],i.price=String(i.price).split(".").join("."),i.layout=e.template.content.layout,t.prepareShopsmart(e,a.data[0])}})}else setTimeout(watchShopsmart,1e3,e)})},{key:"prepareShopsmart",value:function(e,t){this.languages.request(this.language,e.platform,!1);this.$("body").append('<div id="shopback-'+e.id+'" class="shopsmart-container"></div>'),this.$("#shopback-"+e.id).attr("data-platform",e.platform).attr("data-close",e.close.duration).html(this.requestTemplate("shopsmart",t)),this.showCampaign(e.id)}},{key:"watchShoplive",value:function(e){window.shopback.client_id,window.shopback.customer_id;this.prepareShoplive(e,e.template.content)}},{key:"prepareShoplive",value:function(e,t){this.languages.request(this.language,e.platform,!1);if(console.log("Busca por campanhas"),!window.shopback.shoplive_time){var a=!0,o=this;window.shopback.shoplive_time=setInterval(function(){console.log("loop"),a&&(0,u["default"])("GET",o.base_api+"clients/"+window.shopback.client_id+"/customers/"+window.shopback.customer_id+"/live",function(i,n){i&&!n&&i.data.details&&(clearInterval(window.shopback.shoplive_time),t.title=i.data.details.content.title,t.message=i.data.details.content.message,t.link=i.data.details.content.link,console.log(i),o.$("body").append('<div id="shopback-'+e.id+'" class="shoplive-container"></div>'),o.$("#shopback-"+e.id).attr("data-platform",e.platform).html(o.requestTemplate("shoplive",t)),o.showCampaign(e.id),a=!1)})},1e4)}}},{key:"watchShopbot",value:function(e){window.shopback.client_id,window.shopback.customer_id;this.prepareShopbot(e,e.template.content)}},{key:"prepareShopbot",value:function(e,t){this.languages.request(this.language,e.platform,!1);this.$("body").append('<div id="shopback-'+e.id+'" class="shopbot-container"></div>'),this.$("#shopback-"+e.id).attr("data-platform",e.platform).html(this.requestTemplate("shopbot",t)),this.showCampaign(e.id)}},{key:"showCampaign",value:function(e){var t=this.$("#shopback-"+e);"shoppush"!==t.attr("data-platform")||window.shoppush_opened?"shopsmart"===t.attr("data-platform")?t.removeClass("shopsmart-container").addClass("shopsmart-container-show").css("opacity","1"):"shoplive"===t.attr("data-platform")?t.removeClass("shoplive-container").addClass("shoplive-container-show").css("opacity","1"):"shopbot"===t.attr("data-platform")&&t.removeClass("shopbot-container").addClass("shopbot-container-show").css("opacity","1"):(t.removeClass("shoppush-container").addClass("shoppush-container-show").css("opacity","1"),window.shoppush_opened=!0)}},{key:"setInteraction",value:function(e,t,a){window.shopback.setMetadata("interaction",{platform:e,category:"onsite",campaign:t,type:a,subtype:"campaign"})}},{key:"closeCampaign",value:function(e,t){var a=this.$("#shopback-"+e);t?(0,r.setCookie)("sback_campaign_"+e,"closed",0,t):((0,r.setCookie)("sback_campaign_"+e,"closed",0,a.attr("data-close")),a.remove(),this.$(".shoppush-container").remove(),this.$(".shoppush-container-show").remove())}},{key:"loadDependency",value:function(e,t,a,o){var i=this;(0,p["default"])(this.config[e.platform.toUpperCase()][t],function(){a&&a(),i.loadCampaign(e)},o)}},{key:"requestTemplate",value:function(e,t){return"undefined"!=typeof this.templates[e]&&("undefined"!=typeof this.templates[e][t.layout+".html"]&&this.renderizeTemplate(e,this.templates[e][t.layout+".html"],t))}},{key:"renderizeTemplate",value:function(e,t,a){var o,i,n=this,s=t.match(/{{var_(.*?)}}/gi),r=t.match(/{{lang_(.*?)}}/gi);return s&&s.forEach(function(i){o=i.replace("{{var_","").replace("}}",""),t="string"==typeof a[o]||"number"==typeof a[o]?t.replace(i,a[o]):"string"==typeof n.config[e.toUpperCase()][o.toUpperCase()]?t.replace(i,n.config[e.toUpperCase()][o.toUpperCase()]):"number"==typeof n.config[e.toUpperCase()][o.toUpperCase()]?t.replace(i,n.config[e.toUpperCase()][o.toUpperCase()]):t.replace(i,"")}),r&&r.forEach(function(a){o=a.replace("{{lang_","").replace("}}",""),i=n.languages.request(n.language,e,o),t="string"==typeof i||"number"==typeof i?t.replace(a,i):t.replace(a,"")}),t}}]),e}();a["default"]=h},{"./cookie":4,"./languages":6,"./load-resource":7,"./request":9}],3:[function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),s=e("./request"),r=o(s),c=e("./msk"),u=o(c),d=function(){function e(t,a){i(this,e),this.base_pool=t,this.access_token=null,this.client_id=null,this.customer_id=null,this.queue=[],this.filter_map={email:"e",facebook:"f",webpush:"w",celphone:"c",telephone:"t"},this.msk=new u["default"](a)}return n(e,[{key:"updateAccessToken",value:function(e){this.msk.updateAccessToken(e),this.access_token=e}},{key:"updateClient",value:function(e){this.msk.updateClient(e),this.client_id=e}},{key:"updateCustomer",value:function(e){this.msk.updateCustomer(e),this.customer_id=e}},{key:"getBrowserID",value:function(e){(0,r["default"])("GET",this.base_pool+"browser?source="+encodeURIComponent(window.location.href),e)}},{key:"getInformation",value:function(e,t,a){t?(0,r["default"])("GET",this.base_pool+"get?filter="+e+"&strict="+t+"&source="+encodeURIComponent(window.location.href),a,!1,this.access_token):(0,r["default"])("GET",this.base_pool+"get?filter="+e+"&source="+encodeURIComponent(window.location.href),a,!1,this.access_token)}},{key:"setData",value:function(e,t){e&&(t||e.pool===!0)&&this.queue.push(e)}},{key:"hasData",value:function(){return 0!==this.queue.length}},{key:"sendData",value:function(e){var t=this;if(0!==this.queue.length&&this.access_token){var a=this.queue.pop();a&&this.filter_map[a.type]&&this.msk.execute({metadata:JSON.stringify({client:this.client_id,customer:this.customer_id,value:a.value,domain:a.domain?a.domain:"all"})},function(o,i){o&&!i&&(0,r["default"])("POST",t.base_pool+"set?filter="+t.filter_map[a.type]+"&source="+encodeURIComponent(window.location.href),e,o,t.access_token),t.queue.length>0&&t.sendData(e)})}}}]),e}();a["default"]=d},{"./msk":8,"./request":9}],4:[function(e,t,a){"use strict";function o(e,t,a,o){var i=new Date,n=i.getTime();o?i.setTime(n+1e3*o):i.setTime(n+36e5*a);var s=i.toUTCString(),r=location.host.replace(/^www/,"");document.cookie=e+"="+t+";expires="+s+";domain="+r+";path=/"}function i(e){var t=document.cookie,a=t.indexOf(e+"=");if(a===-1)t=!1;else{a=t.indexOf("=",a)+1;var o=t.indexOf(";",a);o===-1&&(o=t.length),t=unescape(t.substring(a,o))}return t}Object.defineProperty(a,"__esModule",{value:!0}),a.setCookie=o,a.getCookie=i},{}],5:[function(e,t,a){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.from_zanox={},this.from_criteo={},this.from_chaordic={}}return n(e,[{key:"detectFromChaordic",value:function(){if("object"!==i(window.chaordic_meta))return!1;if("undefined"==typeof window.chaordic_meta.page)return!1;if("string"==typeof window.chaordic_meta.page&&["cart","product","transaction","confirmation"].indexOf(window.chaordic_meta.page)>-1&&(this.from_chaordic.page=window.chaordic_meta.page),"object"===i(window.chaordic_meta.page)&&"string"==typeof window.chaordic_meta.page.name&&["cart","product","transaction","confirmation"].indexOf(window.chaordic_meta.page.name)>-1&&(this.from_chaordic.page=window.chaordic_meta.page.name),!this.from_chaordic.page)return!1;if("product"===this.from_chaordic.page){if("string"==typeof window.chaordic_meta.pid?this.from_chaordic.metadata={product_id:window.chaordic_meta.pid}:"string"==typeof window.chaordic_meta.product.id&&(this.from_chaordic.metadata={product_id:window.chaordic_meta.product.id}),"object"===i(window.chaordic_meta.product.skus)){for(var e=[],t=0;t<window.chaordic_meta.product.skus.length;t++)window.chaordic_meta.product.skus[t].sku&&e.push(window.chaordic_meta.product.skus[t].sku);e.length>0&&(this.from_chaordic.metadata.product_skus=e)}}else if("cart"===this.from_chaordic.page){var a=!1;if("object"===i(window.chaordic_meta.cart)?"object"===i(window.chaordic_meta.cart.items)&&(a=window.chaordic_meta.cart.items):"object"===i(window.chaordic_meta.items)&&(a=window.chaordic_meta.items),!a)return!1;for(var o=[],t=0;t<a.length;t++)a[t].quantity&&(a[t].product||a[t].pid||a[t].sku)&&("object"===i(a[t].product)?o.push({product_id:a[t].product.id,price:a[t].product.price,quantity:a[t].quantity}):"string"!=typeof a[t].pid&&"string"!=typeof a[t].sku||o.push({product_id:a[t].pid,product_sku:a[t].sku,price:a[t].price,quantity:a[t].quantity}));o.length>0&&(this.from_chaordic.metadata={products:o})}else if("transaction"===this.from_chaordic.page||"confirmation"===this.from_chaordic.page){this.from_chaordic.page="confirmation";var n=!1;if("undefined"!=typeof window.chaordic_meta.id?n=window.chaordic_meta.id:"undefined"!=typeof window.chaordic_meta.transaction.id&&(n=window.chaordic_meta.transaction.id),n){var s=!1;if("object"===i(window.chaordic_meta.transaction)?"object"===i(window.chaordic_meta.transaction.items)&&(s=window.chaordic_meta.transaction.items):"object"===i(window.chaordic_meta.items)&&(s=window.chaordic_meta.items),!s)return!1;for(var o=[],r=0,t=0;t<s.length;t++)s[t].quantity&&(s[t].product||s[t].pid||s[t].sku)&&("object"===i(s[t].product)?(r+=s[t].product.price*s[t].quantity,o.push({product_id:s[t].product.id,price:s[t].product.price,quantity:s[t].quantity})):"string"!=typeof s[t].pid&&"string"!=typeof s[t].sku||(r+=s[t].price*s[t].quantity,o.push({product_id:s[t].pid,product_sku:s[t].sku,price:s[t].price,quantity:s[t].quantity})));o.length>0&&(this.from_chaordic.metadata={id:n,price:r,products:o})}}return!(!this.from_chaordic.page||!this.from_chaordic.metadata)&&this.from_chaordic}},{key:"detectFromZanox",value:function(){if("object"!==i(window.zanox))return!1;if("string"==typeof window.zx_identifier)this.from_zanox.page="product",this.from_zanox.metadata={product_id:window.zx_identifier};else if("object"===i(window.zxprodids)&&"object"===i(window.zxqtds)&&"undefined"==typeof window.zx_transaction){this.from_zanox.page="cart";for(var e=[],t=zxprodids[0].split(","),a=zxqtds[0].split(","),o=zxprecos[0].split(","),n=0;n<t.length;n++)a[n]&&o[n]&&e.push({product_id:String(t[n]),price:parseFloat(o[n]),quantity:parseInt(a[n])});e.length>0&&(this.from_zanox.metadata={products:e})}else"string"==typeof window.zx_transaction&&"undefined"!=typeof window.zx_total_amount&&(this.from_zanox.page="confirmation",this.from_zanox.metadata={id:window.zx_transaction,price:window.zx_total_amount,products:[]});return!(!this.from_zanox.page||!this.from_zanox.metadata)&&this.from_zanox}},{key:"detectFromCriteo",value:function(){for(var e,t=!1,a=!1,o=document.querySelectorAll("script[data-owner]"),n=o.length-1;n>-1;){if(e=o[n],/widget\.criteo\.com/.test(e.src)){t=e.src;break}n--}if(!t)return!1;if(t=this.parseURL(t),"object"!==i(t.searchObject))return!1;for(var s in t.searchObject){if(t.searchObject[s]=decodeURIComponent(decodeURIComponent(t.searchObject[s])),t.searchObject[s].indexOf("e=vp")>-1){a=t.searchObject[s];break}if(t.searchObject[s].indexOf("e=vb")>-1){a=t.searchObject[s];break}if(t.searchObject[s].indexOf("e=vc")>-1){a=t.searchObject[s];break}}if(!a)return!1;for(var r={},c=a.split("&"),u=0;u<c.length;u++){var d=c[u].split("=");r[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}if("string"!=typeof r.e)return!1;if("vp"===r.e)"string"==typeof r.p&&(this.from_criteo.page="product",this.from_criteo.metadata={product_id:r.p});else if("vb"===r.e){if("string"==typeof r.p){this.from_criteo.page="cart";var p=[];r.p=r.p.replace("[","").replace("]","").split(",");for(var u=0;u<r.p.length;u++){for(var l={},c=r.p[u].split("&"),f=0;f<c.length;f++){var d=c[f].split("=");"i"===d[0]?l.product_id=String(decodeURIComponent(d[1])):"pr"===d[0]?l.price=parseFloat(decodeURIComponent(d[1])):"q"===d[0]&&(l.quantity=parseInt(decodeURIComponent(d[1])))}l.product_id&&l.price&&l.quantity&&p.push(l)}p.length>0&&(this.from_criteo.metadata={products:p})}}else if("vc"===r.e&&"string"==typeof r.p&&"string"==typeof r.id){this.from_criteo.page="confirmation";var h=0,p=[];r.p=r.p.replace("[","").replace("]","").split(",");for(var u=0;u<r.p.length;u++){for(var l={},c=r.p[u].split("&"),f=0;f<c.length;f++){var d=c[f].split("=");"i"===d[0]?l.product_id=String(decodeURIComponent(d[1])):"pr"===d[0]?l.price=parseFloat(decodeURIComponent(d[1])):"q"===d[0]&&(l.quantity=parseInt(decodeURIComponent(d[1])))}l.product_id&&l.price&&l.quantity&&(p.push(l),h+=l.quantity*l.price)}p.length>0&&(this.from_criteo.metadata={id:r.id,price:h,products:p})}return!(!this.from_criteo.page||!this.from_criteo.metadata)&&this.from_criteo}},{key:"parseURL",value:function(e){var t,a,o,i=document.createElement("a"),n={};for(i.href=e,t=i.search.replace(/^\?/,"").split("&"),o=0;o<t.length;o++)a=t[o].split("="),n[a[0]]=a[1];return{protocol:i.protocol,host:i.host,hostname:i.hostname,port:i.port,pathname:i.pathname,search:i.search,searchObject:n,hash:i.hash}}}]),e}();a["default"]=s},{}],6:[function(e,t,a){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.languages={},this.languages.pt_BR={},this.languages.pt_BR.shoppush={},this.languages.pt_BR.shoppush.btn_allow="Permitir",this.languages.pt_BR.shoppush.btn_deny="Agora n&atilde;o",this.languages.pt_BR.shoppush.powered="Powered by ShopBack",this.languages.pt_BR.shoppush.are_asking="est&aacute; solicitando",this.languages.pt_BR.shoppush.show_notifications="Mostrar notifica&ccedil;&otilde;es",this.languages.pt_BR.shoppush.popup_wants_send="deseja enviar notifica&ccedil;&otilde;es",this.languages.pt_BR.shoppush.popup_notification_title="Exemplo de Notifica&ccedil;&atilde;o",this.languages.pt_BR.shoppush.popup_notification_message="Veja como aparecer&aacute; em seu aparelho.",this.languages.pt_BR.shopsmart={},this.languages.pt_BR.shoplive={},this.languages.pt_BR.shoplive.btn_allow="Permitir",this.languages.pt_BR.shoplive.btn_deny="Agora n&atilde;o",this.languages.pt_BR.shoplive.powered="Powered by ShopBack",this.languages.pt_BR.shoplive.are_asking="est&aacute; solicitando",this.languages.pt_BR.shoplive.show_notifications="Mostrar notifica&ccedil;&otilde;es",this.languages.pt_BR.shoplive.popup_wants_send="deseja enviar notifica&ccedil;&otilde;es",this.languages.pt_BR.shoplive.popup_notification_title="Exemplo de Notifica&ccedil;&atilde;o",this.languages.pt_BR.shoplive.popup_notification_message="Veja como aparecer&aacute; em seu aparelho.",this.languages.pt_BR.shopbot={},this.languages.pt_BR.shopbot.btn_allow="Permitir",this.languages.pt_BR.shopbot.btn_deny="Agora n&atilde;o",this.languages.pt_BR.shopbot.powered="Powered by ShopBack",this.languages.pt_BR.shopbot.are_asking="est&aacute; solicitando",this.languages.pt_BR.shopbot.show_notifications="Mostrar notifica&ccedil;&otilde;es",this.languages.pt_BR.shopbot.popup_wants_send="deseja enviar notifica&ccedil;&otilde;es",this.languages.pt_BR.shopbot.popup_notification_title="Exemplo de Notifica&ccedil;&atilde;o",this.languages.pt_BR.shopbot.popup_notification_message="Veja como aparecer&aacute; em seu aparelho."}return n(e,[{key:"request",value:function(e,t,a){return"object"===i(this.languages[e])&&(t===!1&&a===!1?this.languages[e]:"object"===i(this.languages[e][t])&&(a===!1?this.languages[e][t]:"undefined"!=typeof this.languages[e][t][a]&&this.languages[e][t][a]))}}]),e}();a["default"]=s},{}],7:[function(e,t,a){"use strict";function o(e,t,a){var o=!1,i=!1;"css"===a?(i=document.createElement("link"),i.href=e,i.rel="stylesheet",i.type="text/css"):(i=document.createElement("script"),i.src=e,i.async=!0),i&&(i.onreadystatechange=i.onload=function(){o||i.readyState&&!/loaded|complete/.test(i.readyState)||(o=!0,t&&t())},document.querySelector("head").appendChild(i))}Object.defineProperty(a,"__esModule",{value:!0}),a["default"]=o},{}],8:[function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),s=e("./request"),r=o(s),c=function(){function e(t){i(this,e),this.base_api=t,this.access_token=null,this.client_id=null,this.customer_id=null}return n(e,[{key:"updateAccessToken",value:function(e){this.access_token=e}},{key:"updateClient",value:function(e){this.client_id=e}},{key:"updateCustomer",value:function(e){this.customer_id=e}},{key:"execute",value:function(e,t){return e&&this.access_token&&this.client_id&&this.customer_id?void(0,r["default"])("POST",this.base_api+"clients/"+this.client_id+"/customers/"+this.customer_id+"/secrets/create",function(a,o){if(a&&!o){var i=a.data.secret,n=btoa(encodeURIComponent(JSON.stringify(e)));n=n.split("").reverse().join(""),n=n.split("");var s=i.substr(0,24),r=i.substr(24);r=r.split("");for(var c={},u=0;u<r.length;u++)u%2==0&&(c["key_"+r[u]]=r[u+1]);for(var d=[],u=0;u<n.length;u++)c.hasOwnProperty("key_"+n[u])?d.push(c["key_"+n[u]]):d.push(n[u]);d.push(s),t({code:d.join("")},!1)}},!1,this.access_token):void t(null,new Error("Invalid data"))}}]),e}();a["default"]=c},{"./request":9}],9:[function(e,t,a){"use strict";function o(e,t,a,o,i){var n=new Headers;n.append("Content-Type","application/json"),i&&n.append("Authorization","Bearer "+i);var s={method:e,headers:n,credentials:"include",mode:"cors"};o&&(s.body=JSON.stringify(o)),fetch(t,s).then(function(e){return e.status>=200&&e.status<300||404===e.status?e.json():Promise.reject(e.statusText)}).then(function(e){a(e,null)})["catch"](function(e){a(null,e)})}Object.defineProperty(a,"__esModule",{value:!0}),a["default"]=o},{}],10:[function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./components/cookie"),s=e("./components/load-resource"),r=o(s),c=e("./components/request"),u=(o(c),e("./components/api")),d=o(u),p=e("./components/helper"),l=o(p),f=e("./components/cookie-pool"),h=o(f),m=e("./components/campaigns"),_=o(m);!function(e,t){function a(){e.is_running&&(window.localStorage.setItem("sback_time_spent",Math.round(((new Date).getTime()-J.LOCAL_DATE)/1e3)),setTimeout(a,200))}function o(){if(String(J.LOCATION)!==String(location.href)){e.is_running=!1,delete window.shopback;var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.defer=!0,t.src="//static.shopback.net/tags/init.js?nocache="+(new Date).getTime(),t.setAttribute("data-client",J.CLIENT);try{document.querySelector("head").appendChild(t);
}catch(a){console.log("Changing address, now is without SB tag")}}else setTimeout(o,500)}function s(e){if(e.length<1)return e;if("undefined"==typeof e.deny)return e;var t="deny";if("undefined"!=typeof e.deny_reverse&&e.deny_reverse===!0)var t="allow";var a={};a[t]={};for(var o=e.deny.split("|"),i=0;i<o.length;i++){var n=o[i].split(":");a[t][n[0]]=n[1].split(";")}return{filters:a}}function c(e,t){if(!e&&!t)return void console.log("Invalid parameters for Recommendations");if("function"==typeof e&&(t=e,e={}),"object"===("undefined"==typeof e?"undefined":i(e))&&"function"==typeof t){var a=[],o=window.localStorage.getItem("sback_anonymous")||"{}";o=JSON.parse(o);var n=o.visits_products?o.visits_products:[];if("object"===("undefined"==typeof n?"undefined":i(n)))for(var s=0;s<n.length&&!(a.length>=5);s++)"object"===i(n[s].metadata)&&"string"==typeof n[s].metadata.product_id&&(a.indexOf(n[s].metadata.product_id)>-1||a.push(n[s].metadata.product_id));Y.API.getRecommendations({options:e,visits:a,keywords:encodeURIComponent(document.title)},t)}}function u(e){var t=[],a=window.localStorage.getItem("sback_anonymous")||"{}";a=JSON.parse(a);var o=a.visits_products?a.visits_products:[];if("object"===("undefined"==typeof o?"undefined":i(o)))for(var n=0;n<o.length&&!(t.length>=5);n++)"object"===i(o[n].metadata)&&"string"==typeof o[n].metadata.product_id&&(t.indexOf(o[n].metadata.product_id)>-1||t.push(o[n].metadata.product_id));Y.API.getLastViewed({visits:t},e)}function p(e,t){"string"==typeof e&&"object"===("undefined"==typeof t?"undefined":i(t))&&J.METADATAS.indexOf(e)>-1&&(x("Set "+e+" metadata",t),F[e.toUpperCase()]=t)}function f(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&(!(!e.page||"string"!=typeof e.page)&&(!(!e.metadata||"object"!==i(e.metadata))&&(J.PAGE=e.page,void("product"===e.page?p("page",{type:"product",metadata:e.metadata}):"cart"===e.page?p("cart",e.metadata.products):"confirmation"===e.page&&p("order",e.metadata)))))}function m(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(document.location.search))return decodeURIComponent(e[1])}function g(e){if("object"===("undefined"==typeof e?"undefined":i(e))&&"object"===i(e.caller)&&"automatic"===e.caller.type){var t=[],a=[];if(e.caller.rules.length<1)return!1;for(var o=0;o<e.caller.rules.length;o++){var n=e.caller.rules[o],s=!1,r=!1;if("url"===n.element)s=String(location.href),"http://"!==n.value.substr(0,7)&&"https://"!==n.value.substr(0,8)&&(s=String(document.location.href).split(document.domain+"/")[1]),r=s;else if("window"===n.element){for(var c=n.subelement.split("."),u=0;u<c.length&&(s=u<1?"undefined"!=typeof window[c[u]]&&window[c[u]]:"undefined"!=typeof s[c[u]]&&s[c[u]],s);u++);"function"==typeof s.toString&&(r=s.toString())}else"html-id"===n.element?(s=document.querySelector("#"+n.subelement),s||(s=!1),"undefined"!=typeof s.innerHTML&&(r=s.innerHTML)):"html-class"===n.element&&(s=document.querySelector("."+n.subelement),s||(s=!1),"undefined"!=typeof s.innerHTML&&(r=s.innerHTML));if("equal"===n.filter&&(n.value===r?t.push(n.value):a.push(n.value)),"different"===n.filter&&(n.value!==r?t.push(n.value):a.push(n.value)),"starts-with"===n.filter&&(r.substr(0,n.value.length)===n.value?t.push(n.value):a.push(n.value)),"ends-with"===n.filter&&(r.substr(n.value.length*-1)===n.value?t.push(n.value):a.push(n.value)),"contains"===n.filter&&(r.indexOf(n.value)>-1?t.push(n.value):a.push(n.value)),"not-contains"===n.filter&&(r.indexOf(n.value)===-1?t.push(n.value):a.push(n.value)),"smaller-than"===n.filter&&(isNaN(r)?a.push(n.value):r<n.value?t.push(n.value):a.push(n.value)),"bigger-than"===n.filter&&(isNaN(r)?a.push(n.value):r>n.value?t.push(n.value):a.push(n.value)),"exists"===n.filter&&(s?t.push(n.value):a.push(n.value)),"not-exists"===n.filter&&(s?a.push(n.value):t.push(n.value)),"has-attr"===n.filter&&("function"==typeof s.getAttribute?s.getAttribute(n.value)?t.push(n.value):a.push(n.value):s.hasOwnProperty(n.value)?t.push(n.value):a.push(n.value)),"has-attr-value"===n.filter){var d=!1;if("function"==typeof s.getAttribute){for(var l in s.attributes)if(s.attributes[l].value===n.value){d=!0,t.push(n.value);break}d||a.push(n.value)}else{for(var l in s)if(s[l]===n.value){d=!0,t.push(n.value);break}d||a.push(n.value)}}}var f=!1;if("any-rules"===e.caller.criteria?t.length>0&&(f=!0):"all-rules"===e.caller.criteria&&t.length>0&&a.length<1&&(f=!0),f===!0){x("Positive status for event",e);var h=!1;if("object"===i(e.metadata)&&"enabled"===e.metadata.status){x("Checking event metadata",e);var h=y(e);"object"!==("undefined"==typeof h?"undefined":i(h))?h=!1:Object.keys(h).length<1&&(h=!1),x("Result of event metadata",h?h:{})}return h?"product"===e.metadata.type?p("page",{type:"product",metadata:h}):p(e.metadata.type,h):Y.API.trackingEvent({event:e.id}),!0}return x("Negative status for event",e),!1}}function y(e){if("object"===("undefined"==typeof e?"undefined":i(e))&&"object"===i(e.metadata)&&"enabled"===e.metadata.status){var t=!1,a=!1;if("window"===e.metadata.from.type){for(var o=e.metadata.from.element.split("."),n=0;n<o.length;n++){if(n<1)t="undefined"!=typeof window[o[n]]&&window[o[n]];else if(Array.isArray(t)){for(var s=!1,r=0;r<t.length;r++)if("undefined"!=typeof t[r][o[n]]){s=!0,t="undefined"!=typeof t[r][o[n]]&&t[r][o[n]];break}s||(t=!1)}else t="undefined"!=typeof t[o[n]]&&t[o[n]];if(!t)break}if(!t||"object"!==("undefined"==typeof t?"undefined":i(t)))return!1;if("cart"===e.metadata.type){if(a=[],!Array.isArray(t))return!1;for(var n=0;n<t.length;n++){var c=t[n];if("object"===("undefined"==typeof c?"undefined":i(c))&&!Array.isArray(c)){for(var u={},r=0;r<e.metadata.attributes.length;r++){var d=e.metadata.attributes[r];"undefined"!=typeof c[d.value]&&"object"!==i(c[d.value])&&(u[d.name]=c[d.value])}Object.keys(u).length===e.metadata.attributes.length&&a.push(u)}}}else{a={};for(var r=0;r<e.metadata.attributes.length;r++){var d=e.metadata.attributes[r];if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("undefined"!=typeof t[n][d.value]&&"object"!==i(t[n][d.value])){a[d.name]=t[n][d.value];break}}else"undefined"!=typeof t[d.value]&&"object"!==i(t[d.value])&&(a[d.name]=t[d.value])}Object.keys(a).length!==e.metadata.attributes.length&&(a=!1)}}else if("html"===e.metadata.from.type){if(isNaN(e.metadata.from.element)&&(t=document.querySelector(e.metadata.from.element)),!t||"object"!==("undefined"==typeof t?"undefined":i(t)))return!1;if("cart"===e.metadata.type){a=[];for(var u={},r=0;r<e.metadata.attributes.length;r++){var d=e.metadata.attributes[r];t.querySelector(d.value)&&(u[d.name]=t.querySelectorAll(d.value))}if(u.length!==e.metadata.attributes.length)return!1;for(var p={},l=Object.keys(u),r=0;r<u[l[0]].length;r++)u[l[0]][r]&&u[l[1]][r]&&"undefined"!=typeof u[l[0]][r].innerHTML&&"undefined"!=typeof u[l[1]][r].innerHTML&&(p[l[0]]=u[l[0]][r].innerHTML,p[l[1]]=u[l[1]][r].innerHTML,a.push(p))}else{a={};for(var r=0;r<e.metadata.attributes.length;r++){var d=e.metadata.attributes[r];t.querySelector(d.value)&&(a[d.name]=t.querySelector(d.value).innerHTML)}Object.keys(a).length!==e.metadata.attributes.length&&(a=!1)}}return!(!a||Object.keys(a).length<1)&&a}}function b(e,t){e&&!t&&J.ANONYMOUS&&(J.ANONYMOUS_DATA=window.localStorage.getItem("sback_anonymous")||"{}",J.ANONYMOUS_DATA=JSON.parse(J.ANONYMOUS_DATA),Y.API.updateAnonymousData(J.ANONYMOUS_DATA),Y.API.updateClient(null),Y.API.updateCustomer(null),Y.API.updateAccessToken(null),Y.COOKIE_POOL.updateClient(null),Y.COOKIE_POOL.updateCustomer(null),Y.COOKIE_POOL.updateAccessToken(null),(0,n.setCookie)("sback_access_token","",-1),I())}function v(e,t){e&&!t&&(Y.COOKIE_POOL.hasData()?Y.COOKIE_POOL.sendData(b):b(e,t))}function O(){var t="object"===i(F.HELPER)&&F.HELPER,a="object"===i(F.CONTACT)&&F.CONTACT,o="object"===i(F.PAGE)&&F.PAGE,s="object"===i(F.CART)&&F.CART,c="object"===i(F.ORDER)&&F.ORDER,u="object"===i(F.EVENTS)&&F.EVENTS,d="object"===i(F.INTERACTION)&&F.INTERACTION,p="object"===i(F.BILLET)&&F.BILLET;if(t&&J.HELPERS.indexOf(t)===-1&&(J.HELPERS.push(t),(0,r["default"])(J.BASE_URL_HELPERS+t+".js")),a&&JSON.stringify(a)!==JSON.stringify(Y.API.data.contact)&&J.CONTACTS.indexOf(a.type)>-1&&(x("Found new CONTACT metadata",a),Y.COOKIE_POOL.setData(a,J.PARTNER),Y.API.setContact(a,function(e,t){e&&!t&&(J.ANONYMOUS_DATA=window.localStorage.getItem("sback_anonymous")||"{}",J.ANONYMOUS_DATA=JSON.parse(J.ANONYMOUS_DATA),J.ANONYMOUS_DATA.contact=a.type,J.CUSTOMER_CONTACTS[a.type]=!0,window.localStorage.setItem("sback_anonymous",JSON.stringify(J.ANONYMOUS_DATA)),window.localStorage.setItem("sback_contacts",JSON.stringify(J.CUSTOMER_CONTACTS)),v(e,t))})),o)if(e.page_type=o.type,J.ANONYMOUS){if(JSON.stringify(o)!==JSON.stringify(H.PAGE)&&(x("Found new PAGE metadata",o),H.PAGE=o,J.ANONYMOUS_DATA=window.localStorage.getItem("sback_anonymous")||"{}",J.ANONYMOUS_DATA=JSON.parse(J.ANONYMOUS_DATA),"product"===H.PAGE.type)){var l=H.PAGE;l.date=J.SERVER_DATE,J.ANONYMOUS_DATA.visits_products=J.ANONYMOUS_DATA.visits_products?J.ANONYMOUS_DATA.visits_products:[],"object"===i(J.ANONYMOUS_DATA.visits_products)?(J.ANONYMOUS_DATA.visits_products.unshift(l),J.ANONYMOUS_DATA.visits_products.length>=8&&J.ANONYMOUS_DATA.visits_products.pop()):(J.ANONYMOUS_DATA.visits_products=[],J.ANONYMOUS_DATA.visits_products.unshift(l)),window.localStorage.setItem("sback_anonymous",JSON.stringify(J.ANONYMOUS_DATA))}}else JSON.stringify(o)!==JSON.stringify(Y.API.data.page)&&(x("Found new PAGE metadata",o),Y.API.trackingPage(o));if(s&&JSON.stringify(s)!==JSON.stringify(Y.API.data.cart)){x("Found new CART metadata",s),Y.API.trackingCart({cart:J.CART,metadata:s,information:J.INTERACTIONS},function(e,t){e&&!t&&(J.CART=e.data.cart,(0,n.setCookie)("sback_cart",J.CART,24))});try{if(Array.isArray(s))for(var f=0;f<s.length;f++)"undefined"!=typeof s[f].product_id&&z.push(s[f].product_id)}catch(h){console.log("Error on products requests from cart",h)}}c&&JSON.stringify(c)!==JSON.stringify(Y.API.data.order)&&(x("Found new ORDER metadata",c),Y.API.trackingOrder({order:J.ORDER,cart:J.CART,metadata:c,information:J.INTERACTIONS},function(e,t){e&&!t&&(J.CART=!1,J.ORDER=e.data.order,(0,n.setCookie)("sback_cart","",-1),(0,n.setCookie)("sback_order",J.ORDER,.1))})),u&&u.forEach(function(e,t){J.DEBUG_EVENTS.indexOf(e.id)===-1&&(J.DEBUG_EVENTS.push(e.id),x("Found new EVENT metadata",e)),g(e)===!0&&u.splice(t,1)}),d&&JSON.stringify(d)!==JSON.stringify(Y.API.data.interaction)&&Y.API.trackingInteraction(d,null),p&&(Y.API.trackingEvent(p),F.BILLET=""),setTimeout(function(){O()},1e3)}function E(){if("object"===i(window._sback_cart_data)){var e=!1,t=!1,a=!1;try{e=Y.HELPER.detectFromChaordic(),t=Y.HELPER.detectFromZanox(),a=Y.HELPER.detectFromCriteo()}catch(o){console.log("Erro ao obter informações de metadata para cart",o)}e||t||a?e?f(e):t?f(t):a&&f(a):p("cart",window._sback_cart_data)}setTimeout(function(){E()},1e3)}function w(){if("object"===i(window._cv_data)&&window._cv_data){var e=!1,t=!1,a=!1;try{e=Y.HELPER.detectFromChaordic(),t=Y.HELPER.detectFromZanox(),a=Y.HELPER.detectFromCriteo()}catch(o){console.log("Erro ao obter informações de metadata para order",o)}e||t||a?t?f(t):a?f(a):e&&f(e):p("order",{id:window._cv_data.order_id?window._cv_data.order_id:"unknown",price:window._cv_data.valor?window._cv_data.valor:1})}setTimeout(function(){w()},1e3)}function k(){var e=(0,n.getCookie)("sb_days")||!1,t=1;return e&&(t=Math.round(((new Date).getTime()-e)/1e3)),t}function S(t,a){if(t&&!a){if("object"!==i(t.keys))return!1;if(t.keys.length<1)return!1;e.setMetadata("contact",{type:"automatic",values:t.keys})}}function A(e){if(J.PARTNER)return!1;var t=((0,n.getCookie)("sback_customer_e")||!1,(0,n.getCookie)("sback_customer_f")||!1,(0,n.getCookie)("sback_customer_w")||!1);(0,n.getCookie)("sback_customer_c")||!1,(0,n.getCookie)("sback_customer_t")||!1;e.webpush===!0||t||(Y.COOKIE_POOL.getInformation("w",!1,S),(0,n.setCookie)("sback_customer_w",!0,12))}function C(e,t){if(!e||t)return void console.log("Failed when try to set pageview");if(e.data){var o=(0,n.getCookie)("sback_current_session")||!1,s=(0,n.getCookie)("sback_total_sessions")||!1,r=(0,n.getCookie)("sb_days")||!1;o||((0,n.setCookie)("sback_current_session",1,1),s?(0,n.setCookie)("sback_total_sessions",parseInt(s,0)+1,8760):(0,n.setCookie)("sback_total_sessions",1,8760)),r||(0,n.setCookie)("sb_days",(new Date).getTime(),8760),J.ANONYMOUS=e.data.anonymous,J.SERVER_DATE=e.data.time,J.ANONYMOUS?(J.ANONYMOUS_DATA=window.localStorage.getItem("sback_anonymous")||"{}",J.ANONYMOUS_DATA=JSON.parse(J.ANONYMOUS_DATA),J.ANONYMOUS_DATA.first_seen||(J.ANONYMOUS_DATA.first_seen={referrer:encodeURIComponent(document.referrer),date:J.SERVER_DATE}),J.ANONYMOUS_DATA.last_seen={referrer:encodeURIComponent(document.referrer),date:J.SERVER_DATE},J.ANONYMOUS_DATA.visits_products||(J.ANONYMOUS_DATA.visits_products=[]),window.localStorage.setItem("sback_anonymous",JSON.stringify(J.ANONYMOUS_DATA)),x("Saving information about session for anonymous customer")):(a(),J.SESSION=e.data.session,J.PAGEVIEW=e.data.pageview,(0,n.setCookie)("sback_session",J.SESSION,1),(0,n.setCookie)("sback_pageview",J.PAGEVIEW,720),x("Saving information about session for identified customer")),A(J.CUSTOMER_CONTACTS),e.data.page?"unknown"!==e.data.page.type&&(F.PAGE=e.data.page,x("Updating PAGE metadata",F.PAGE),"object"===i(e.data.page.metadata)&&"string"==typeof e.data.page.metadata.product_id&&z.push(e.data.page.metadata.product_id)):e.data.helper&&(F.HELPER=e.data.helpers,x("Updating HELPER metadata",F.HELPER)),e.data.events&&(F.EVENTS=e.data.events,x("Updating EVENTS metadata",F.EVENTS)),e.data.campaigns&&(x("Init campaigns",e.data.campaigns),Y.CAMPAIGNS=new _["default"](J.BASE_URL_API,J.BASE_URL_STATICS,J.LANGUAGE),Y.CAMPAIGNS.initialize(e.data.campaigns,J.CUSTOMER_CONTACTS)),setTimeout(function(){O()},100),setTimeout(function(){E()},100),setTimeout(function(){w()},100);var c=(0,n.getCookie)("sback_pid")||!1;c&&(p("interaction",{platform:c,campaign:"unknown",category:"offsite",type:"click",subtype:"campaign"}),(0,n.setCookie)("sback_pid","",-1))}}function T(t,a){return!t||a?void console.log("Customer identification failed"):"undefined"==typeof t.data?void(J.RECONNECTS<3&&(J.RECONNECTS++,I())):"undefined"==typeof t.data.client||"undefined"==typeof t.data.customer||"undefined"==typeof t.data.access_token?void(J.RECONNECTS<3&&(J.RECONNECTS++,I())):(x("Saving session"),J.CLIENT=t.data.client,J.CUSTOMER=t.data.customer,J.ACCESS_TOKEN=t.data.access_token,J.PARTNER=t.data.partner,J.LANGUAGE=t.data.language,J.TIMEZONE=t.data.timezone,e.client_id=J.CLIENT,e.customer_id=J.CUSTOMER,(0,n.setCookie)("sback_client",J.CLIENT,8640),(0,n.setCookie)("sback_customer",J.CUSTOMER,8640),(0,n.setCookie)("sback_access_token",J.ACCESS_TOKEN,22),(0,n.setCookie)("sback_partner",J.PARTNER,8640),Object.keys(t.data.contacts).length>0&&(J.CUSTOMER_CONTACTS=t.data.contacts,window.localStorage.setItem("sback_contacts",JSON.stringify(J.CUSTOMER_CONTACTS)),x("Updating customer contacts")),window.localStorage.setItem("sback_language",J.LANGUAGE),window.localStorage.setItem("sback_timezone",J.TIMEZONE),Y.API.updateAnonymousData(null),Y.API.updateClient(J.CLIENT),Y.API.updateCustomer(J.CUSTOMER),Y.API.updateAccessToken(J.ACCESS_TOKEN),Y.COOKIE_POOL.updateClient(J.CLIENT),Y.COOKIE_POOL.updateCustomer(J.CUSTOMER),Y.COOKIE_POOL.updateAccessToken(J.ACCESS_TOKEN),x("Init customer tracking"),void Y.API.tracking({session:J.SESSION,pageview:J.PAGEVIEW,referrer_url:encodeURIComponent(document.referrer),referrer_spent:J.TIME_SPENT,interactions:J.INTERACTIONS,page:J.PAGE},C))}function N(e,t){return t||!e?void console.log("Browser identification failed"):(J.BROWSER=e.id,(0,n.setCookie)("sback_browser",J.BROWSER,8640),x("Updating browser ID"),Y.API.updateBrowser(J.BROWSER),x("Authenticating customer"),void Y.API.auth({client:J.CLIENT,customer:J.CUSTOMER,browser:J.BROWSER},T))}function I(){J.PARTNER="true"===(0,n.getCookie)("sback_partner"),J.SESSION=(0,n.getCookie)("sback_session")||!1,J.PAGEVIEW=(0,n.getCookie)("sback_pageview")||!1,J.CART=(0,n.getCookie)("sback_cart")||!1,J.ORDER=(0,n.getCookie)("sback_order")||!1,J.TIME_SPENT=window.localStorage.getItem("sback_time_spent")||!1,J.LANGUAGE=window.localStorage.getItem("sback_language")||J.LANGUAGE,J.TIMEZONE=window.localStorage.getItem("sback_timezone")||J.TIMEZONE;var t=(0,n.getCookie)("sback_customer"),a=(0,n.getCookie)("sback_client"),o=(0,n.getCookie)("sback_browser"),i=(0,n.getCookie)("sback_access_token");if(t&&a&&o&&i){J.CLIENT=a,J.CUSTOMER=t,J.BROWSER=o,J.ACCESS_TOKEN=i,Y.API.updateClient(J.CLIENT),Y.API.updateCustomer(J.CUSTOMER),Y.API.updateBrowser(J.BROWSER),Y.API.updateAccessToken(J.ACCESS_TOKEN),Y.COOKIE_POOL.updateClient(J.CLIENT),Y.COOKIE_POOL.updateCustomer(J.CUSTOMER),Y.COOKIE_POOL.updateAccessToken(J.ACCESS_TOKEN);var s=window.localStorage.getItem("sback_contacts")||"{}";s=JSON.parse(s),Object.keys(s).length>0&&(J.CUSTOMER_CONTACTS=s),e.client_id=J.CLIENT,e.customer_id=J.CUSTOMER,x("Init customer tracking"),Y.API.tracking({session:J.SESSION,pageview:J.PAGEVIEW,referrer_url:encodeURIComponent(document.referrer),referrer_spent:J.TIME_SPENT,interactions:J.INTERACTIONS,page:J.PAGE},C)}else x("Retrieving customer browser information"),Y.COOKIE_POOL.getBrowserID(N)}function R(e){try{var t=Y.HELPER.detectFromChaordic(),a=Y.HELPER.detectFromZanox(),o=Y.HELPER.detectFromCriteo();J.DEBUG_MODE&&(console.log("Informações para chaordic",t),console.log("Informações para zanox",a),console.log("Informações para criteo",o)),a?f(a):o?f(o):t&&f(t)}catch(i){console.log("Erro ao obter informações de metadata",i)}I()}function P(){x("Enable public methods"),e.getCookie=n.getCookie,e.setCookie=n.setCookie,e.setMetadata=p,e.trackingDays=k,e.currentProducts=D,e.getRecommendations=c,e.getLastViewed=u,e.version="1.1 - Deploy: 19/06/17 15:05",e.jQuery||(e.jQuery=window.jQuery),e.getRecommendation=c,e.api={getRecommendations:function(t,a){return t||a?("function"==typeof t&&(a=t,t={}),void("object"===("undefined"==typeof t?"undefined":i(t))&&"function"==typeof a&&(t=s(t),e.getRecommendations(t,function(e,t){a(t,e)})))):void console.log("Invalid parameters for legacy function api.Recommendations")}},R()}function L(){Y.HELPER=new l["default"],P()}function U(){Y.COOKIE_POOL=new h["default"](J.BASE_URL_COOKIES,J.BASE_URL_API),L()}function j(e,t){if(e)if(403===e.status){if(Y.API.updateClient(null),Y.API.updateCustomer(null),Y.API.updateAccessToken(null),Y.COOKIE_POOL.updateClient(null),Y.COOKIE_POOL.updateCustomer(null),Y.COOKIE_POOL.updateAccessToken(null),t.attempts>2)return;t.attempts++,Y.API.delayedCall(t),(0,n.setCookie)("sback_access_token","",-1),I()}else{if(t.attempts>2)return;t.attempts++,Y.API.delayedCall(t)}}function M(){Y.API=new d["default"](J.BASE_URL_API),Y.API.onRequestError=j,U()}function D(){return z}function B(){J.INTERACTIONS=window.localStorage.getItem("sback_interactions")||!1,J.INTERACTIONS?J.INTERACTIONS=JSON.parse(J.INTERACTIONS):J.INTERACTIONS={utm_source:!1,utm_medium:!1,utm_campaign:!1,utm_term:!1,utm_content:!1};var e=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"];m("utm_source")&&(J.INTERACTIONS.utm_source=m("utm_source"),e.splice(e.indexOf("utm_source"),1)),m("utm_medium")&&(J.INTERACTIONS.utm_medium=m("utm_medium"),e.splice(e.indexOf("utm_medium"),1)),m("utm_campaign")&&(J.INTERACTIONS.utm_campaign=m("utm_campaign"),e.splice(e.indexOf("utm_campaign"),1)),m("utm_term")&&(J.INTERACTIONS.utm_term=m("utm_term"),e.splice(e.indexOf("utm_term"),1)),m("utm_content")&&(J.INTERACTIONS.utm_content=m("utm_content"),e.splice(e.indexOf("utm_content"),1)),e.length>0&&e.length<5&&e.forEach(function(e,t){J.INTERACTIONS[e]=!1}),window.localStorage.setItem("sback_interactions",JSON.stringify(J.INTERACTIONS)),M()}function q(e){x("Inside request metadata function",t),location.href.indexOf("sbpid=shoptarget")>-1&&((0,n.setCookie)("sback_pid","shoptarget",24),x("Click from platform shoptarget")),"object"===i(t.page)?(F.PAGE=t.page,x("Has PAGE metadata",F.PAGE),delete t.page):"object"===i(window.shopback_product)&&(F.PAGE={type:"product",metadata:window.shopback_product},x("Has PAGE metadata (b)",F.PAGE),delete window.shopback_product),"object"===i(t.cart)&&(F.CART=t.cart,x("Has CART metadata",F.CART),delete t.cart),"object"===i(t.order)&&(F.ORDER=t.order,x("Has ORDER metadata",F.ORDER),delete t.order),setTimeout(q,1500),e===!0&&B()}function x(e,t){return!!e&&void(J.DEBUG_MODE&&(t?console.log("ShopBack Debug: "+e,t):console.log("ShopBack Debug: "+e)))}function G(){if($++,$>6)return void console.log("Maximum initialize tries exceeded");if(!window.Promise)return void(0,r["default"])(J.BASE_URL_STATICS+J.FILE_POLYFILL_PROMISE,G);if(!window.fetch)return void(0,r["default"])(J.BASE_URL_STATICS+J.FILE_POLYFILL_FETCH,G);if(!window.btoa)return void(0,r["default"])(J.BASE_URL_STATICS+J.FILE_POLYFILL_BASE64,G);if(!Function.prototype.bind)return void(0,r["default"])(J.BASE_URL_STATICS+J.FILE_POLYFILL_BIND,G);if(!window.jQuery&&!e.jQuery)return void(0,r["default"])(J.BASE_URL_STATICS+J.FILE_JQUERY,G);if("undefined"!=typeof Prototype&&parseFloat(Prototype.Version.substr(0,3))<1.7&&"undefined"!=typeof Array.prototype.toJSON){var t=JSON.stringify;JSON.stringify=function(e){var a=Array.prototype.toJSON;delete Array.prototype.toJSON;var o=t(e);return Array.prototype.toJSON=a,o}}if(Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),location.href.indexOf("shopback_debug_mode=true")>-1&&(J.DEBUG_MODE=!0),location.href.indexOf("shopback_staging_mode=true")>-1&&(J.STAGING_MODE=!0,J.DOMAIN="https://staging.api.shopback.net/"),e.is_running!==!0){e.is_running=!0,o();for(var a,i=document.querySelectorAll("script[data-client]"),s=i.length-1;s>-1;){if(a=i[s],/init\.js/.test(a.src)&&String(a.src).indexOf(J.BASE_URL_STATICS)>-1){J.CLIENT=a.getAttribute("data-client"),J.CUSTOMER=(0,n.getCookie)("sback_customer")?(0,n.getCookie)("sback_customer"):"anonymous",q(!0);break}s--}}}var J={DOMAIN:"shopback.net",BASE_URL_API:"https://api.shopback.net/",BASE_URL_COOKIES:"https://ckies.net/",BASE_URL_STATICS:"//static.shopback.net/",BASE_URL_HELPERS:"//static.shopback.net/js/helpers/",FILE_POLYFILL_PROMISE:"tags/polyfill/promise.js",FILE_POLYFILL_FETCH:"tags/polyfill/fetch.js",FILE_POLYFILL_BASE64:"tags/polyfill/base64.js",FILE_POLYFILL_BIND:"tags/polyfill/bind.js",FILE_JQUERY:"tags/jquery.js",ANONYMOUS:!0,ANONYMOUS_DATA:[],CLIENT:!1,CUSTOMER:!1,CUSTOMER_CONTACTS:{email:!1,webpush:!1,facebook:!1,celphone:!1,telephone:!1},PARTNER:!1,SESSION:!1,PAGEVIEW:!1,TIME_SPENT:!1,ACCESS_TOKEN:!1,CART:!1,ORDER:!1,INTERACTIONS:!1,HELPERS:[],METADATAS:["page","cart","order","contact","interaction","billet"],CONTACTS:["email","facebook","webpush","celphone","telephone","automatic"],LOCATION:String(location.href),PAGE:!1,VERSION:"2.0",LANGUAGE:"pt_BR",TIMEZONE:"America/Sao_Paulo",LOCAL_DATE:(new Date).getTime(),RECONNECTS:0,SERVER_DATE:!1,DEBUG_MODE:!1,STAGING_MODE:!1,DEBUG_EVENTS:[]},Y={API:!1,COOKIE_POOL:!1,CAMPAIGNS:!1,HELPER:!1},F={HELPER:!1,PAGE:{type:"unknown"}},H={PAGE:{type:"unknown"}},z=[],$=0;G()}(window.shopback=window.shopback||{},window.shopback_metadata=window.shopback_metadata||{})},{"./components/api":1,"./components/campaigns":2,"./components/cookie":4,"./components/cookie-pool":3,"./components/helper":5,"./components/load-resource":7,"./components/request":9}]},{},[10]);